class HomepageManager{constructor(){this.currentSlide=0,this.slides=[],this.searchResults=[],this.currentTab="tours",this.init()}init(){this.loadContent(),this.bindEvents(),this.initializeSliders(),this.initializeSearch(),this.initializeKeyboardNavigation(),this.initializeTestimonials(),this.initializeAccordion(),this.initializeNavbarDropdowns(),this.removeBlogSection()}async loadContent(){try{await this.loadFeaturedTours(),await this.loadTopRatedHotels(),await this.loadRecentCars(),await this.loadCategories(),console.log("âœ… All content loaded successfully")}catch(e){console.error("âŒ Error loading content:",e)}}async loadFeaturedTours(){try{const e=await apiManager.getFeaturedTours(6);e.success&&this.renderTours(e.data.tours,"featured-tours")}catch(e){console.error("Error loading featured tours:",e)}}async loadTopRatedHotels(){try{const e=await apiManager.getTopRatedHotels(10);e.success&&this.renderHotels(e.data.hotels,"top-rated-hotels")}catch(e){console.error("Error loading top-rated hotels:",e)}}async loadRecentCars(){try{const e=await apiManager.getRecentCars(8);e.success&&this.renderCars(e.data.cars,"recent-cars")}catch(e){console.error("Error loading recent cars:",e)}}async loadCategories(){try{const e=await apiManager.getPopularCategories(8);e.success&&this.renderCategories(e.data.categories,"top-categories")}catch(e){console.error("Error loading categories:",e)}}async loadBlogPosts(){}renderTours(e,t){const n=document.getElementById(t);if(!n)return;const s=n.querySelector(".grid");s&&(s.innerHTML=e.map((e,t)=>{let n="text-yellow-500";"Best Value"===e.rating.badge?n="text-green-500":"New"===e.rating.badge&&(n="text-orange-500");let s="";return 0===t?s="lg:-ml-10":1===t?s="lg:-mr-4 lg:-ml-4":2===t&&(s="lg:-mr-4"),`\n        <div class="relative rounded-2xl overflow-visible hover:shadow-2xl transition ${s}">\n          <div class="relative rounded-2xl overflow-hidden pb-28">\n            <img src="${e.image}" alt="${e.title}" class="w-full h-[320px] object-cover rounded-2xl">\n            \n            <div class="absolute top-3 left-3 bg-white ${n} text-xs font-semibold px-3 py-1 rounded-full shadow">\n              ${e.rating.badge||"Featured"}\n            </div>\n            \n            <button class="absolute top-3 right-3 bg-white rounded-full p-2 shadow hover:scale-105 transition" onclick="homepageManager.toggleWishlist('${e._id}')">\n              <img src="assets/images/heart.png" alt="Favorite" class="h-4 w-4">\n            </button>\n\n            <div class="absolute bottom-0 left-0 right-0 bg-white rounded-2xl p-7 shadow-xl border-b-4 border-l-2 border-r-2 border-gray-300 min-h-[200px]">\n              <img src="assets/images/rating1.png" alt="Rating" class="absolute -top-4 right-4 h-9 w-auto drop-shadow-md">\n\n              <h3 class="text-lg font-semibold leading-snug">${e.title}</h3>\n              <div class="mt-3 flex items-center text-gray-500 text-sm gap-6">\n                <div class="flex items-center gap-2">\n                  <img src="assets/images/duration.png" class="h-4 w-4" alt="Duration">\n                  <span>${e.duration.days} days ${e.duration.nights} nights</span>\n                </div>\n                <div class="flex items-center gap-2">\n                  <img src="assets/images/user.png" class="h-4 w-4" alt="Guests">\n                  <span>4-6 guest</span>\n                </div>\n              </div>\n              <div class="mt-5 flex items-center justify-between">\n                <p class="text-lg font-bold">$${e.price.amount} <span class="text-sm font-normal text-gray-500">/ person</span></p>\n                <button class="px-4 py-2 bg-gray-600/30 text-white text-sm rounded-full hover:bg-gray-600/50 transition" onclick="homepageManager.bookTour('${e._id}')">\n                  Book Now\n                </button>\n              </div>\n            </div>\n          </div>\n        </div>\n      `}).join(""))}renderHotels(e,t){const n=document.getElementById(t);if(!n)return;const s=n.querySelector("#carousel");s&&(s.innerHTML=e.map(e=>`\n      <div class="min-w-[350px] max-w-[350px] snap-start shrink-0">\n        <div class="relative rounded-3xl overflow-visible hover:shadow-2xl transition">\n          <div class="relative rounded-3xl overflow-hidden pb-32">\n            <img src="${e.images.main}" alt="${e.name}" class="w-full h-[280px] object-cover rounded-3xl">\n            \n            <button class="absolute top-4 right-4 bg-white rounded-full p-2.5 shadow-lg hover:scale-110 transition" onclick="homepageManager.toggleWishlist('${e._id}')">\n              <svg class="h-5 w-5 text-gray-700" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"/>\n              </svg>\n            </button>\n\n            <div class="absolute top-[240px] right-5 bg-white px-3 py-1.5 rounded-full shadow-lg flex items-center gap-1.5">\n              <span class="text-yellow-500">â­</span>\n              <span class="text-sm font-bold">${e.rating.score}</span>\n              <span class="text-xs text-gray-500">(${e.rating.reviews} reviews)</span>\n            </div>\n\n            <div class="absolute bottom-0 left-0 right-0 bg-white rounded-3xl p-6 shadow-xl border-2 border-gray-300">\n              <h3 class="text-xl font-bold leading-tight mb-2">${e.name}</h3>\n              \n              <div class="flex items-center gap-2 text-gray-500 text-sm mb-1">\n                <svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"/>\n                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"/>\n                </svg>\n                <span>${e.location.city}, ${e.location.country}</span>\n              </div>\n\n              <div class="flex gap-0.5 mb-4">\n                <span class="text-black text-lg">${"â˜…".repeat(e.rating.stars)}</span>\n              </div>\n\n              <div class="flex items-center justify-between">\n                <div>\n                  <p class="text-2xl font-bold">$${e.price.perNight} <span class="text-sm font-normal text-gray-500">/ night</span></p>\n                </div>\n                <button class="px-6 py-2.5 bg-black text-white text-sm rounded-lg hover:bg-gray-800 transition font-semibold" onclick="homepageManager.bookHotel('${e._id}')">\n                  Book Now\n                </button>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    `).join(""))}renderCars(e,t){const n=document.getElementById(t);if(!n)return;const s=n.querySelector(".grid");s&&(s.innerHTML=e.map(e=>`\n      <div class="relative rounded-2xl overflow-visible hover:shadow-2xl transition">\n        <div class="relative rounded-2xl overflow-hidden pb-28">\n          <img src="${e.image}" alt="${e.brand} ${e.model}" class="w-full h-[320px] object-cover rounded-2xl">\n          <button class="absolute top-3 right-3 bg-white rounded-full p-2 shadow hover:scale-105 transition" onclick="homepageManager.toggleWishlist('${e._id}')">\n            <img src="assets/images/heart.png" class="h-4 w-4" alt="heart">\n          </button>\n\n          <div class="absolute -bottom-8 left-5">\n            <img src="assets/images/rating1.png" alt="Rating" class="h-6 w-auto object-contain drop-shadow-lg">\n          </div>\n\n          <div class="absolute -bottom-16 left-0 right-0 bg-white rounded-2xl p-6 shadow-xl border-b-4 border-l-2 border-r-2 border-gray-300 min-h-[180px]">\n            <h3 class="text-lg font-semibold mb-1 mt-4">${e.brand} ${e.model}</h3>\n            <p class="text-gray-500 text-sm mb-3 flex items-center gap-1">\n              <img src="assets/images/location.png" class="h-4 w-4" alt="Location">\n              ${e.location.city}, ${e.location.country}\n            </p>\n            <div class="grid grid-cols-2 gap-3 mb-3 text-sm text-gray-600">\n              <div class="flex items-center gap-2">\n                <img src="assets/images/mile.png" class="h-4 w-4" alt="Mileage">\n                <span>${e.specifications.mileage.toLocaleString()} miles</span>\n              </div>\n              <div class="flex items-center gap-2">\n                <img src="assets/images/automatic.png" class="h-4 w-4" alt="Transmission">\n                <span>${e.specifications.transmission}</span>\n              </div>\n              <div class="flex items-center gap-2">\n                <img src="assets/images/fuel.png" class="h-4 w-4" alt="Fuel">\n                <span>${e.specifications.fuelType}</span>\n              </div>\n              <div class="flex items-center gap-2">\n                <img src="assets/images/seat.png" class="h-4 w-4" alt="Seats">\n                <span>${e.specifications.seats} seats</span>\n              </div>\n            </div>\n            <div class="flex items-center justify-between pt-3 border-t border-gray-200">\n              <div>\n                <span class="text-xl font-bold">$${e.price.amount}</span>\n                <span class="text-gray-500 text-sm"> / ${e.price.per}</span>\n              </div>\n              <button class="px-5 py-2 bg-gray-600/30 text-white text-sm font-medium rounded-full hover:bg-gray-600/50 transition" onclick="homepageManager.bookCar('${e._id}')">\n                Book Now\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n    `).join(""))}renderCategories(e,t){const n=document.getElementById(t);if(!n)return;const s=n.querySelector(".grid");s&&(s.innerHTML=e.map((e,t)=>{let n="";return n=0===t||4===t?"lg:-ml-10 lg:-mr-2":3===t||7===t?"lg:-mr-4 lg:-ml-2":"lg:-ml-2 lg:-mr-2",`\n        <div class="bg-white rounded-2xl p-4 border border-gray-200 hover:shadow-lg transition hover:-translate-y-1 cursor-pointer ${n}" onclick="homepageManager.filterByCategory('${e.slug}')">\n          <img src="${e.image}" alt="${e.name}" class="w-full h-40 object-cover rounded-xl mb-3">\n          <div class="flex items-center justify-between">\n            <div>\n              <h3 class="font-semibold text-base">${e.name}</h3>\n              <p class="text-gray-500 text-sm">${e.stats.tours} Tours, ${e.stats.activities} Activities</p>\n            </div>\n            <img src="assets/images/rightarrow.png" alt="Arrow" class="h-4 w-auto opacity-80">\n          </div>\n        </div>\n      `}).join(""))}renderBlogPosts(e,t){}removeBlogSection(){const e=document.getElementById("blog-posts");e&&e.parentNode&&e.parentNode.removeChild(e)}initializeSliders(){this.initializeHeroSlider(),this.initializeHotelCarousel(),this.initializeCarCarousel()}initializeHeroSlider(){const e=document.querySelector('section[style*="background-image"]');if(!e)return void console.log("Hero section not found");const t=document.getElementById("heroPrevBtn"),n=document.getElementById("heroNextBtn"),s=e.querySelectorAll('img[src*="hero-thumb"]');console.log("Hero elements found:",{leftArrow:!!t,rightArrow:!!n,thumbnails:s.length}),this.heroSlides=[{background:"assets/images/Background.png",title:"Discover Amazing Places",subtitle:"Explore the world with our curated travel experiences"},{background:"assets/images/california_sunset.png",title:"California Sunset Adventures",subtitle:"Experience breathtaking sunsets along the California coast"},{background:"assets/images/grand_canyon.png",title:"Grand Canyon Wonders",subtitle:"Discover the awe-inspiring beauty of the Grand Canyon"}],this.currentSlide=0,console.log("Hero slides initialized:",this.heroSlides.length,"slides"),t&&t.addEventListener("click",e=>{e.preventDefault(),console.log("Left arrow clicked"),this.previousHeroSlide()}),n&&n.addEventListener("click",e=>{e.preventDefault(),console.log("Right arrow clicked"),this.nextHeroSlide()}),s.forEach((e,t)=>{e.addEventListener("click",()=>this.goToSlide(t))}),setInterval(()=>this.nextHeroSlide(),5e3)}nextHeroSlide(){console.log("nextHeroSlide called, current slide:",this.currentSlide),this.currentSlide=(this.currentSlide+1)%this.heroSlides.length,console.log("New slide:",this.currentSlide),this.updateHeroSlide()}previousHeroSlide(){console.log("previousHeroSlide called, current slide:",this.currentSlide),this.currentSlide=(this.currentSlide-1+this.heroSlides.length)%this.heroSlides.length,console.log("New slide:",this.currentSlide),this.updateHeroSlide()}goToSlide(e){console.log("goToSlide called, index:",e),this.currentSlide=e,this.updateHeroSlide()}updateHeroSlide(){const e=document.querySelector('section[style*="background-image"]');if(!e||!this.heroSlides)return void console.log("Hero section or slides not found");const t=this.heroSlides[this.currentSlide];console.log("Updating hero slide to:",t.background),e.style.backgroundImage=`url('${t.background}')`,e.querySelectorAll('img[src*="hero-thumb"]').forEach((e,t)=>{t===this.currentSlide?e.classList.add("border-yellow-400","border-2"):e.classList.remove("border-yellow-400","border-2")})}initializeHotelCarousel(){const e=document.getElementById("carousel"),t=document.getElementById("prevBtn"),n=document.getElementById("nextBtn");if(!e||!t||!n)return;const s=Array.from(e.children);if(0===s.length)return;s.forEach(t=>{const n=t.cloneNode(!0);e.appendChild(n)});let o=0;const i=s.length,r=(t=!0)=>{e.scrollTo({left:374*o,behavior:t?"smooth":"auto"})};n.addEventListener("click",()=>{o++,r(),o>=i&&setTimeout(()=>{o=0,r(!1)},400)}),t.addEventListener("click",()=>{o--,o<0?(o=i-1,e.scrollTo({left:374*i,behavior:"auto"}),setTimeout(()=>{o=i-1,r(!1)},10)):r()})}initializeCarCarousel(){if(!document.getElementById("recent-cars"))return;const e=document.getElementById("carPrevBtn"),t=document.getElementById("carNextBtn"),n=document.getElementById("carsGrid");if(!e||!t||!n)return;let s=0;const o=()=>{const e=n.children;Array.from(e).forEach((e,t)=>{e.style.display=t>=s&&t<s+4?"block":"none"})};t.addEventListener("click",()=>{const e=Math.max(0,n.children.length-4);s=Math.min(s+1,e),o()}),e.addEventListener("click",()=>{s=Math.max(0,s-1),o()}),o()}initializeSearch(){this.initializeSearchBox(),this.initializeSearchSuggestions()}initializeSearchBox(){const e=document.querySelector("#search-box-wrapper");if(!e)return void console.log("Search box not found");e.querySelectorAll('button[class*="px-5 py-2"]').forEach(e=>{e.addEventListener("click",t=>{t.preventDefault(),this.switchSearchTab(e.textContent.trim())})});const t=e.querySelector('button[class*="bg-black"]');t&&t.addEventListener("click",e=>{e.preventDefault(),this.performSearch()}),this.makeSearchFieldsInteractive(e),this.setupSearchDropdowns(e)}makeSearchFieldsInteractive(e){e.querySelectorAll('span[class*="text-gray-900"]').forEach(e=>{"true"!==e.dataset.disableSuggestions&&e.addEventListener("click",t=>{t.preventDefault(),console.log("Field clicked:",e.textContent.trim())})})}setupSearchDropdowns(e){try{const t=e.querySelectorAll("[data-dropdown-toggle]");if(!t.length)return;const n=()=>{["locationDropdown","datesDropdown","guestsDropdown"].forEach(t=>{const n=e.querySelector("#"+t);n&&n.classList.add("hidden")})};t.forEach(t=>{t.addEventListener("click",s=>{s.preventDefault();const o=t.getAttribute("data-dropdown-toggle"),i=e.querySelector("#"+o+"Dropdown");i&&(n(),"dates"===o&&(p?m=new Date(p.getFullYear(),p.getMonth(),1):v?m=new Date(v.getFullYear(),v.getMonth(),1):(m=new Date,m.setDate(1)),w()),i.classList.toggle("hidden"))})}),document.addEventListener("click",t=>{e.contains(t.target)||n()});const s=e.querySelector("#locationValue"),o=e.querySelector("#locationDropdown"),i=e.querySelector("#locationInput");o&&s&&(o.querySelectorAll(".city-option").forEach(e=>{e.addEventListener("click",()=>{s.textContent=e.textContent.trim(),n()})}),i&&i.addEventListener("input",()=>{const e=i.value.toLowerCase();o.querySelectorAll(".city-option").forEach(t=>{t.classList.toggle("hidden",!t.textContent.toLowerCase().includes(e))})}));const r=e.querySelector("#datesDropdown"),a=e.querySelector("#calendars"),l=e.querySelector("#prevMonth"),c=e.querySelector("#nextMonth"),d=e.querySelector("#clearDates"),g=e.querySelector("#applyDates"),u=e.querySelector("#checkInValue"),h=e.querySelector("#checkOutValue");let m=new Date;m.setDate(1);let p=null,v=null;const b=e=>e?e.toLocaleDateString(void 0,{day:"2-digit",month:"long",year:"numeric"}):"Add dates",x=()=>{u&&(u.textContent=b(p)),h&&(h.textContent=b(v))},y=(e,t)=>e&&t&&e.toDateString()===t.toDateString(),f=(e,t,n)=>t&&n&&e>t&&e<n;function w(){if(!a)return;a.innerHTML="";const e=new Date(m),t=new Date(m.getFullYear(),m.getMonth()+1,1);a.appendChild(S(e)),a.appendChild(S(t))}function S(e){const t=document.createElement("div"),n=e.toLocaleDateString(void 0,{month:"long",year:"numeric"}),s=document.createElement("div");s.className="text-sm font-semibold mb-3",s.textContent=n,t.appendChild(s);const o=document.createElement("div");o.className="grid grid-cols-7 gap-1.5 sm:gap-2 text-center text-xs text-gray-400 mb-1","S M T W T F S".split(" ").forEach(e=>{const t=document.createElement("div");t.textContent=e,o.appendChild(t)}),t.appendChild(o);const i=document.createElement("div");i.className="grid grid-cols-7 gap-1.5 sm:gap-2 text-center text-sm";const r=new Date(e).getDay(),a=new Date(e.getFullYear(),e.getMonth()+1,0).getDate();for(let e=0;e<r;e++){const e=document.createElement("div");e.className="h-9 sm:h-10",i.appendChild(e)}for(let t=1;t<=a;t++){const n=new Date(e.getFullYear(),e.getMonth(),t),s=document.createElement("button");s.className="w-9 h-9 sm:w-10 sm:h-10 inline-flex items-center justify-center rounded-full mx-auto hover:bg-gray-100",y(n,p)||y(n,v)?s.classList.add("bg-black","text-white","hover:bg-black"):f(n,p,v)&&s.classList.add("bg-gray-200"),s.textContent=String(t),s.addEventListener("click",()=>{!p||p&&v?(p=n,v=null):n<p?(v=p,p=n):v=n,w(),x()}),i.appendChild(s)}const l=42-(r+a);for(let e=0;e<l;e++){const e=document.createElement("div");e.className="h-9 sm:h-10",i.appendChild(e)}return t.appendChild(i),t}r&&(w(),l&&l.addEventListener("click",()=>{m.setMonth(m.getMonth()-1),w()}),c&&c.addEventListener("click",()=>{m.setMonth(m.getMonth()+1),w()}),d&&d.addEventListener("click",()=>{p=null,v=null,w(),x()}),g&&g.addEventListener("click",()=>{p&&!v&&(v=p),x(),n()}),x());const k={adults:2,children:0,infants:0},E=e.querySelector("#guestsValue");e.querySelectorAll(".counter-btn").forEach(t=>{t.addEventListener("click",()=>{const n=t.getAttribute("data-target"),s=t.getAttribute("data-op");k[n]=Math.max(0,k[n]+("+"===s?1:-1));const o=e.querySelector("#"+n+"Count");o&&(o.textContent=k[n])})});const C=e.querySelector("#applyGuests");C&&C.addEventListener("click",()=>{E&&(E.textContent=`${k.adults} adults, ${k.children} children`),n()})}catch(L){console.warn("Search dropdowns setup failed:",L)}}switchSearchTab(e){this.currentTab=e.toLowerCase(),document.querySelectorAll('#search-box-wrapper button[class*="px-5 py-2"]').forEach(e=>{e.textContent.trim().toLowerCase()===this.currentTab?e.className="px-5 py-2 bg-black text-white rounded-full text-sm font-medium":e.className="px-5 py-2 bg-gray-100 rounded-full text-sm hover:bg-gray-200"})}async performSearch(){console.log("Performing search...");const e=document.querySelectorAll('#search-box-wrapper span[class*="text-gray-900"]'),t=e[0]?.textContent||"",n=e[1]?.textContent||"",s=e[2]?.textContent||"",o=e[3]?.textContent||"";console.log("Search params:",{location:t,checkIn:n,checkOut:s,guests:o,tab:this.currentTab});try{const e=t||this.currentTab,n=[this.currentTab||"tours"],s=await apiManager.search(e,n,20);s.success?this.displaySearchResults(s.data.results||s.data):this.showSearchError("No results found for your search.")}catch(e){console.error("Search error:",e),this.showMockSearchResults(t,this.currentTab)}}displaySearchResults(e){let t=document.getElementById("searchResultsModal");t||(t=document.createElement("div"),t.id="searchResultsModal",t.className="fixed inset-0 bg-black bg-opacity-50 z-50 hidden",t.innerHTML='\n        <div class="flex items-center justify-center min-h-screen p-4">\n          <div class="bg-white rounded-2xl shadow-2xl w-full max-w-4xl max-h-[80vh] overflow-hidden">\n            <div class="flex items-center justify-between p-6 border-b border-gray-200">\n              <h2 class="text-2xl font-bold text-gray-900">Search Results</h2>\n              <button id="closeSearchModal" class="text-gray-400 hover:text-gray-600 transition-colors">\n                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>\n                </svg>\n              </button>\n            </div>\n            <div id="searchResultsContent" class="p-6 overflow-y-auto max-h-[60vh]"></div>\n          </div>\n        </div>\n      ',document.body.appendChild(t),document.getElementById("closeSearchModal").addEventListener("click",()=>{t.classList.add("hidden")}),t.addEventListener("click",e=>{e.target===t&&t.classList.add("hidden")}));const n=document.getElementById("searchResultsContent");n&&(n.innerHTML=this.renderSearchResults(e)),t.classList.remove("hidden")}renderSearchResults(e){let t="";return Object.keys(e).forEach(n=>{e[n]&&e[n].length>0&&(t+=`<div class="mb-6">\n          <h3 class="text-lg font-semibold mb-4 capitalize">${n}</h3>\n          <div class="grid gap-4 grid-cols-1 sm:grid-cols-2 lg:grid-cols-3">`,e[n].forEach(e=>{t+=this.renderSearchResultItem(e,n)}),t+="</div></div>")}),t||(t='<div class="text-center py-8"><p class="text-gray-500">No results found. Try different search terms.</p></div>'),t}renderSearchResultItem(e,t){return`\n      <div class="border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow cursor-pointer" onclick="homepageManager.viewItem('${e._id}', '${t}')">\n        <h4 class="font-semibold mb-2">${e.title||e.name||`${e.brand} ${e.model}`}</h4>\n        <p class="text-sm text-gray-600 mb-2">${e.location||e.location?.city||""}</p>\n        <p class="text-lg font-bold text-yellow-600">$${e.price?.amount||e.price?.perNight||0}</p>\n      </div>\n    `}showMockSearchResults(e,t){const n={tours:[{_id:"1",title:"California Sunset Cruise",location:"Los Angeles, CA",price:{amount:89}},{_id:"2",title:"NYC Food Tour",location:"New York, NY",price:{amount:65}},{_id:"3",title:"Grand Canyon Adventure",location:"Arizona, USA",price:{amount:120}}],hotels:[{_id:"1",name:"Luxury Beach Resort",location:"Miami, FL",price:{perNight:250}},{_id:"2",name:"Downtown Hotel",location:"New York, NY",price:{perNight:180}}],cars:[{_id:"1",brand:"BMW",model:"3 Series",location:"San Francisco, CA",price:{amount:89,per:"day"}},{_id:"2",brand:"Audi",model:"A4",location:"Los Angeles, CA",price:{amount:95,per:"day"}}]},s={};s[t]=n[t]||n.tours,this.displaySearchResults(s)}async initializeSearchSuggestions(){document.querySelectorAll('#search-box-wrapper span[class*="text-gray-900"]').forEach(e=>{"true"!==e.dataset.disableSuggestions&&e.addEventListener("click",async()=>{const t=await this.getSearchSuggestions(e.textContent);this.showSuggestions(e,t)})})}async getSearchSuggestions(e){try{const t=await apiManager.getSearchSuggestions(e,5);return t.success?t.data.suggestions:[]}catch(e){return console.error("Error getting suggestions:",e),[]}}showSuggestions(e,t){const n=document.querySelector(".search-suggestions");if(n&&n.remove(),0===t.length)return;const s=document.createElement("div");s.className="search-suggestions absolute top-full left-0 right-0 bg-white border border-gray-200 rounded-lg shadow-lg z-50 mt-1",s.innerHTML=t.map(e=>`\n      <div class="p-3 hover:bg-gray-50 cursor-pointer border-b border-gray-100 last:border-b-0" onclick="homepageManager.selectSuggestion('${e.text}', this)">\n        <div class="font-medium">${e.text}</div>\n        <div class="text-sm text-gray-500">${e.subtitle}</div>\n      </div>\n    `).join(""),e.parentElement.style.position="relative",e.parentElement.appendChild(s),setTimeout(()=>{document.addEventListener("click",function t(n){s.contains(n.target)||n.target===e||(s.remove(),document.removeEventListener("click",t))})},0)}selectSuggestion(e,t){t.closest(".search-suggestions").previousElementSibling.textContent=e,t.closest(".search-suggestions").remove()}initializeKeyboardNavigation(){document.addEventListener("keydown",e=>{if("Tab"===e.key&&e.target.closest("#search-box-wrapper")&&(e.preventDefault(),this.navigateSearchTabs(e.shiftKey)),"ArrowLeft"===e.key||"ArrowRight"===e.key){const t=this.getActiveSlider();t&&(e.preventDefault(),"ArrowLeft"===e.key?this.previousSlide(t):this.nextSlide(t))}"Enter"===e.key&&e.target.closest("#search-box-wrapper")&&(e.preventDefault(),this.performSearch())})}navigateSearchTabs(e){const t=Array.from(document.querySelectorAll('#search-box-wrapper button[class*="px-5 py-2"]')),n=t.findIndex(e=>e.classList.contains("bg-black"));let s;s=e?n>0?n-1:t.length-1:n<t.length-1?n+1:0,t[s].click(),t[s].focus()}getActiveSlider(){const e=document.querySelector('section[style*="background-image"]');if(e&&this.isElementInViewport(e))return"hero";const t=document.getElementById("top-rated-hotels");if(t&&this.isElementInViewport(t))return"hotels";const n=document.getElementById("recent-cars");return n&&this.isElementInViewport(n)?"cars":null}isElementInViewport(e){const t=e.getBoundingClientRect();return t.top>=0&&t.left>=0&&t.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&t.right<=(window.innerWidth||document.documentElement.clientWidth)}bindEvents(){document.addEventListener("submit",e=>{e.target.closest("#search-box-wrapper")&&(e.preventDefault(),this.performSearch())}),document.addEventListener("click",e=>{if(e.target.matches('[onclick*="bookTour"]')){e.preventDefault();const t=e.target.getAttribute("onclick").match(/'([^']+)'/)[1];this.bookTour(t)}if(e.target.matches('[onclick*="bookHotel"]')){e.preventDefault();const t=e.target.getAttribute("onclick").match(/'([^']+)'/)[1];this.bookHotel(t)}if(e.target.matches('[onclick*="bookCar"]')){e.preventDefault();const t=e.target.getAttribute("onclick").match(/'([^']+)'/)[1];this.bookCar(t)}})}async toggleWishlist(e){if(apiManager.isAuthenticated())try{(await apiManager.addToWishlist(e)).success&&this.showMessage("Item added to wishlist!","success")}catch(e){console.error("Wishlist error:",e),this.showMessage("Failed to update wishlist","error")}else this.showMessage("Please log in to add items to your wishlist","warning")}bookTour(e){this.showMessage(`Booking tour ${e}...`,"info")}bookHotel(e){this.showMessage(`Booking hotel ${e}...`,"info")}bookCar(e){this.showMessage(`Booking car ${e}...`,"info")}filterByCategory(e){this.showMessage(`Filtering by category: ${e}`,"info")}viewItem(e,t){this.showMessage(`Viewing ${t} ${e}`,"info")}showMessage(e,t="info"){let n=document.getElementById("homepageMessage");n||(n=document.createElement("div"),n.id="homepageMessage",n.className="fixed top-4 right-4 z-50 max-w-sm",document.body.appendChild(n)),n.innerHTML=`\n      <div class="p-4 rounded-lg border ${{success:"bg-green-100 text-green-800 border-green-200",error:"bg-red-100 text-red-800 border-red-200",warning:"bg-yellow-100 text-yellow-800 border-yellow-200",info:"bg-blue-100 text-blue-800 border-blue-200"}[t]} shadow-lg">\n        <div class="flex items-center justify-between">\n          <span>${e}</span>\n          <button onclick="this.parentElement.parentElement.remove()" class="ml-2 text-lg">&times;</button>\n        </div>\n      </div>\n    `,setTimeout(()=>{n.parentElement&&n.remove()},5e3)}showSearchError(e){this.showMessage(e,"error")}initializeTestimonials(){const e=document.getElementById("testimonials");if(!e)return void console.log("Testimonials container not found");const t=document.getElementById("testimonialsTrack"),n=document.getElementById("testimonialPrev"),s=document.getElementById("testimonialNext"),o=e.querySelectorAll(".testimonial-dot");if(console.log("Testimonials elements found:",{track:t,prevBtn:n,nextBtn:s,dots:o.length}),!t||!n||!s)return void console.log("Missing testimonials elements");const i=Array.from(t.children);i.forEach(e=>{const n=e.cloneNode(!0);t.appendChild(n)});let r=0;const a=i.length,l=(e=!0)=>{const n=100*-r;t.style.transition=e?"transform 0.5s ease-in-out":"none",t.style.transform=`translateX(${n}%)`,t.style.transition="transform 0.5s ease-in-out";const s=r%a;o.forEach((e,t)=>{t===s?(e.classList.remove("bg-gray-300"),e.classList.add("bg-yellow-500")):(e.classList.remove("bg-yellow-500"),e.classList.add("bg-gray-300"))})};s.addEventListener("click",()=>{console.log("Testimonials next button clicked"),r++,l(),r>=a&&setTimeout(()=>{r=0,l(!1)},500)}),n.addEventListener("click",()=>{console.log("Testimonials prev button clicked"),r--,r<0?(r=2*a-1,l(!1),setTimeout(()=>{r=a-1,l()},10)):l()}),o.forEach((e,t)=>{e.addEventListener("click",()=>{r=t,l()})}),setInterval(()=>{r++,l(),r>=a&&setTimeout(()=>{r=0,l(!1)},500)},6e3),l()}initializeAccordion(){const e=document.getElementById("faq");if(!e)return;const t=e.querySelectorAll(".faq-item");t.forEach(e=>{const n=e.querySelector(".faq-question"),s=e.querySelector(".faq-answer"),o=e.querySelector(".faq-icon");n&&s&&o&&(n.addEventListener("click",()=>{const n=!s.classList.contains("hidden");t.forEach(t=>{if(t!==e){const e=t.querySelector(".faq-answer"),n=t.querySelector(".faq-icon");e&&n&&(e.classList.add("hidden"),n.style.transform="rotate(0deg)")}}),n?(s.classList.add("hidden"),o.style.transform="rotate(0deg)"):(s.classList.remove("hidden"),o.style.transform="rotate(180deg)")}),n.addEventListener("keydown",e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),n.click())}),n.setAttribute("tabindex","0"),n.setAttribute("role","button"),n.setAttribute("aria-expanded","false"))})}initializeNavbarDropdowns(){const e=document.querySelector("nav");e&&(Array.from(e.querySelectorAll("li")).filter(e=>e.querySelector('img[src*="drop_down"]')).forEach(e=>{const t=e.querySelector("a");if(!t)return;const n=t.textContent.trim(),s=document.createElement("div");let o;s.className="navbar-dropdown absolute top-full left-0 mt-1 bg-white shadow-2xl border border-gray-100 z-50 hidden",s.style.minWidth="280px",s.innerHTML=this.generateDropdownContent(n),e.style.position="relative",e.appendChild(s),e.addEventListener("mouseenter",()=>{clearTimeout(o),this.closeAllDropdowns(),s.classList.remove("hidden")}),e.addEventListener("mouseleave",()=>{o=setTimeout(()=>{s.classList.add("hidden")},150)}),t.addEventListener("click",e=>{e.preventDefault(),e.stopPropagation(),this.toggleDropdown(s)}),s.addEventListener("click",e=>{e.preventDefault(),e.stopPropagation();const t=e.target.closest(".dropdown-item");t&&(this.handleDropdownItemClick(t,n),s.classList.add("hidden"))})}),document.addEventListener("click",t=>{e.contains(t.target)||this.closeAllDropdowns()}))}generateDropdownContent(e){const t={Home:{title:"Homepage Options",items:[{text:"Homepage 1",icon:"ğŸ ",desc:"Main landing page"},{text:"Homepage 2",icon:"ğŸ¡",desc:"Alternative layout"},{text:"Homepage 3",icon:"ğŸ˜ï¸",desc:"Minimal design"}]},Tours:{title:"Tour Categories",items:[{text:"City Tours",icon:"ğŸ™ï¸",desc:"Urban exploration"},{text:"Adventure Tours",icon:"â›°ï¸",desc:"Thrilling experiences"},{text:"Cultural Tours",icon:"ğŸ›ï¸",desc:"Heritage & history"},{text:"Food Tours",icon:"ğŸ½ï¸",desc:"Culinary adventures"},{text:"Nature Tours",icon:"ğŸŒ¿",desc:"Wildlife & landscapes"}]},Destinations:{title:"Popular Destinations",items:[{text:"Europe",icon:"ğŸ‡ªğŸ‡º",desc:"Historic cities & culture"},{text:"Asia",icon:"ğŸŒ",desc:"Ancient traditions & modern cities"},{text:"Americas",icon:"ğŸŒ",desc:"Diverse landscapes & cultures"},{text:"Africa",icon:"ğŸŒ",desc:"Safari & adventure"},{text:"Oceania",icon:"ğŸŒŠ",desc:"Islands & beaches"}]},Activities:{title:"Activity Types",items:[{text:"Water Sports",icon:"ğŸ„â€â™‚ï¸",desc:"Surfing, diving, sailing"},{text:"Hiking & Trekking",icon:"ğŸ¥¾",desc:"Mountain trails & nature"},{text:"Cultural Activities",icon:"ğŸ­",desc:"Museums, festivals, art"},{text:"Adventure Sports",icon:"ğŸ§—â€â™‚ï¸",desc:"Rock climbing, bungee"},{text:"Relaxation",icon:"ğŸ§˜â€â™€ï¸",desc:"Spa, yoga, meditation"}]},Hotel:{title:"Accommodation Types",items:[{text:"Luxury Hotels",icon:"ğŸ¨",desc:"5-star premium stays"},{text:"Boutique Hotels",icon:"ğŸ©",desc:"Unique & stylish"},{text:"Resorts",icon:"ğŸ–ï¸",desc:"All-inclusive experiences"},{text:"Budget Hotels",icon:"ğŸª",desc:"Affordable & comfortable"},{text:"Hostels",icon:"ğŸ›ï¸",desc:"Social & budget-friendly"}]},Rental:{title:"Rental Services",items:[{text:"Car Rental",icon:"ğŸš—",desc:"Self-drive adventures"},{text:"Bike Rental",icon:"ğŸš²",desc:"Eco-friendly exploration"},{text:"Equipment Rental",icon:"ğŸ’",desc:"Gear for activities"},{text:"Yacht Charter",icon:"â›µ",desc:"Luxury sailing"}]},Tickets:{title:"Transportation",items:[{text:"Flight Tickets",icon:"âœˆï¸",desc:"Domestic & international"},{text:"Train Tickets",icon:"ğŸš„",desc:"High-speed & scenic"},{text:"Bus Tickets",icon:"ğŸšŒ",desc:"Intercity & local"},{text:"Event Tickets",icon:"ğŸ«",desc:"Concerts & shows"}]},Pages:{title:"Site Pages",items:[{text:"About Us",icon:"â„¹ï¸",desc:"Our story & mission"},{text:"Contact",icon:"ğŸ“",desc:"Get in touch"},{text:"FAQ",icon:"â“",desc:"Frequently asked questions"},{text:"Terms & Conditions",icon:"ğŸ“‹",desc:"Legal information"},{text:"Privacy Policy",icon:"ğŸ”’",desc:"Data protection"}]},Blog:{title:"Travel Blog",items:[{text:"Travel Tips",icon:"ğŸ’¡",desc:"Expert advice & guides"},{text:"Destination Guides",icon:"ğŸ—ºï¸",desc:"Detailed travel info"},{text:"Travel Reviews",icon:"â­",desc:"User experiences"},{text:"Travel News",icon:"ğŸ“°",desc:"Latest updates"}]}}[e]||{title:"Options",items:[{text:"Option 1",icon:"ğŸ“„",desc:"Description here"},{text:"Option 2",icon:"ğŸ“„",desc:"Description here"},{text:"Option 3",icon:"ğŸ“„",desc:"Description here"}]};return`\n      <div class="dropdown-header px-4 py-3 border-b border-gray-100 bg-gray-50">\n        <h3 class="text-sm font-semibold text-gray-900">${t.title}</h3>\n      </div>\n      <div class="dropdown-content py-2">\n        ${t.items.map(e=>`\n          <div class="dropdown-item px-4 py-3 hover:bg-gray-50 cursor-pointer transition-colors">\n            <div class="flex items-center space-x-3">\n              <span class="text-lg">${e.icon}</span>\n              <div class="flex-1">\n                <div class="text-sm font-medium text-gray-900">${e.text}</div>\n                <div class="text-xs text-gray-500">${e.desc}</div>\n              </div>\n            </div>\n          </div>\n        `).join("")}\n      </div>\n    `}toggleDropdown(e){this.closeAllDropdowns(),e.classList.toggle("hidden")}closeAllDropdowns(){document.querySelectorAll(".navbar-dropdown").forEach(e=>{e.classList.add("hidden")})}handleDropdownItemClick(e,t){const n=e.querySelector(".text-gray-900").textContent;console.log(`Clicked: ${t} > ${n}`),e.style.backgroundColor="#fef3c7",setTimeout(()=>{e.style.backgroundColor=""},200)}}window.initializeHomepage=function(){if(window.homepageManager instanceof HomepageManager)return window.homepageManager;const e=new HomepageManager;return window.homepageManager=e,e};